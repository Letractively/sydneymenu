{% extends 'core/clean.html' %}
{% load hash_filters %}
{% load comp_filters %}
{% block title %} zoyoe sydneyscent {% endblock %}

{% block css_link %}
  <link rel="stylesheet" href="/css/contrib/element.css" type="text/css" media="all" charset="utf-8"/>
  <link rel="stylesheet" href="/css/contrib/general.css" type="text/css" media="all" charset="utf-8"/>
  <link rel="stylesheet" href="/css/contrib/nav.css" type="text/css" media="all" charset="utf-8"/>
  <link rel="stylesheet" href="/css/default/dialog.css" type="text/css" media="all" charset="utf-8"/>
  <link rel="stylesheet" href="/css/default/admin.css" type="text/css" media="all" charset="utf-8"/>

{% endblock %}

{% block js_link %}
  <script type="text/javascript" charset="utf-8"
          src="http://yui.yahooapis.com/3.2.0/build/yui/yui-min.js">
  </script>
  <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
  <script type="text/javascript" src="/js/comps.js"></script>
  <script type="text/javascript" src="/js/zoyoe.js"></script>
  <script type="text/javascript" src="/js/ele.js"></script>
  <script type="text/javascript" src="/js/mesh.js"></script>
  <script type="text/javascript" src="/js/ui.js"></script>

  <script type="text/javascript">
   {% if DATA|length == 0 and SIDEDATA|length == 0 %}
    zoyoe.maptoggle = 1;
   {% else %}
    zoyoe.maptoggle = 0;
   {% endif %}
   function mapToggle(){
      zoyoe.maptoggle = 1 - zoyoe.maptoggle;
      YUI().use('node','anim',function(Y){
        if(zoyoe.maptoggle == 1){
          var anim = new Y.Anim({
            node:'#map-lane',
            to:{height:"380px"},
            duration:0.2,
          });
          anim.run();
          Y.one('#rslt-block').setStyle('marginTop',"400px");
        }else{
          Y.one('#rslt-block').setStyle('marginTop',"120px");
          Y.one('#map-lane').setStyle('height',"100px");
        } 
      });
    }
    function document_load(){
      YUI().use('node','event','anim','io-form',function(Y){
        if(zoyoe.maptoggle == 1){
          zoyoe.maptoggle = 0;
          mapToggle();
        }
       	var zoom = 15;
      	var center = null;
        {% if LOC %}
        if({{LOC.x}} != 0 && {{LOC.y}} != 0){
          center = new Microsoft.Maps.Location({{LOC.x}},{{LOC.y}});
        }
        {% endif %}
        zoyoe.admin = InitAdmin(zoyoe);
        zoyoe.service_name = '{{SERVICE.name}}';
        if(zoyoe.ElementExtension){
          zoyoe.ElementExtension.BuildExtensionElements();
        }
        zoyoe.InitZoyoe(false,Y);
        zoyoe.ArrangeClips('services','data')
      });
    }
  </script>
{% endblock %}

{% block bar %}
{% endblock %}

{% block nav %}
  <li class='menu'><a href='/zoyoe/'>Zoyoe</a></li>
  <li class='menu'><a href='/search/'>Service Cards</a></li>
  <li class='menu'><a href='/map/'>Distribution</a></li>
  <li class='menu'><a href='/forum/'>Forum</a></li>
  <li class='menu'><a href='/gallery/main'>Gallery</a></li>
  {% if user.is_authenticated %}
  <li class='menu' onclick ="zoyoe.admin.Logout()"><a>Logout</a></li>
  {% else %}
    <li class='menu' onclick ="zoyoe.admin.ShowLoginDialog()"><a>Login</a></li>
    <li class='menu' onclick ="zoyoe.admin.ShowRegisterDialog()"><a>Register</a></li>
  {% endif %}
{% endblock %}

{% block content %}
  <div id='map-lane' onclick="mapToggle()">
    <div class='dense' style="float:left;">
    </div>
    <div id="report-bar">
    </div>
  </div>
  <div id='rslt-block' style="margin-top:120px;">
   <div class='mid-section' id='services' style="clear:both;">
   </div>
   <div id='data' class='tmp'>
       {% for service in DATA %}
          <div class='clip'>
          <img src="/gallery/image/{{service.name}}/default/icon/?"></img>
          <ul>
          <li class='fade right'>{{service.type}}</li>
          <li class='name'><a href="/core/service/{{service.name}}">{{service.name}}</a></li>
          <li class='fade'>{{service.email}}</li>
          <li class='dscp'>{{service.description}}</li>
          </ul>
        </div>
        {% endfor %}
   </div>
   <div class='mid-section' id = "items" style="clear:both;">
   </div>
   <div id = 'sidedata' class='tmp'>
        {% for info in SIDEDATA%}
          {% with info|info as data %}
          {% with data|hash:"ATTRS" as attrs %}
          {% with data|hash:"TEXT" as description %}
            <div class='clip'>
              <a href="/core/service/{{info.service}}/">
               <img src="{{attrs|hashout:'icon'}}/?sc=true">
               </img>
              </a>
              <ul>
              <li class='name'><a href="/core/service/{{info.service}}/">{{attrs|hashout:'name'}}</a>
              {% for attr in attrs %}
                <li class='fade'>{{attr}}:<span>{{attrs|hash:attr}}</span></li>
              {% endfor %}
              <li class='fade'>collected in <a href="/core/service/{{info.service}}/">{{info.service}}</a></span></li>
              <li class='dscp'>{{description}}</li>
              </ul>
           </div>
          {%endwith%}
          {%endwith%}
          {%endwith%}
        {% endfor %}
   </div>
  </div><!-- page -->
 </div>
 {% if DATA|length == 0 and SIDEDATA|length == 0 %}
   <div id="research-hint">
   No Results Found, Try Our Recommendations Or Distribution Map ?
   </div>
 {% else %}
 <div id="search-result">
 <span class='snum'>{{DATA|length}}</span> services and <span class='snum'>{{SIDEDATA|length}}</span> items found,<span class='inum'> 0</span> showed. <span class='btn'>show more</span>
 </div>
 {% endif %}
{% endblock %}

{% block tail %}
{% endblock %}
